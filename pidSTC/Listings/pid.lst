C51 COMPILER V9.00   PID                                                                   05/19/2016 16:51:06 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE PID
OBJECT MODULE PLACED IN .\Objects\pid.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE pid.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\pid.lst) TABS(2) OBJECT(.\Objects\pid.obj)

line level    source

   1          #include "pid.h"
   2          
   3          void PIDInit(PID_Uint *sptr)
   4          {
   5   1      //  sptr->SumError = 0;
   6   1        sptr->LastError = 0; //Error[-1]
   7   1        sptr->PrevError = 0; //Error[-2]
   8   1        sptr->Kp = 2.30f; //比例系数
   9   1        sptr->Ki = 1.20f;   //积分系数
  10   1        sptr->Kd = 0.10f; //微分系数
  11   1        sptr->SetValue = 0;
  12   1      }
  13          
  14          /*****************************************************************************************
  15          *函数名：int PID_Calc（int MeasureValue）
  16          *函数功能：PID算法 调节PWM增量
  17          *函数参数：MeasureValue  测得的速度值 PID_Adjust 返回值 PWM误差修正值
  18          *****************************************************************************************/
  19          int PID_Calc(int MeasureValue,PID_Uint *sptr)
  20          {
  21   1        register int iError, PID_Adjust; 
  22   1        iError = sptr->SetValue - MeasureValue;     //计算增加量
  23   1        PID_Adjust = (int)(
  24   1          sptr->Kp * iError       //E[k]项
  25   1        - sptr->Ki * sptr->LastError        //E[k－1]项
  26   1        + sptr->Kd * sptr->PrevError);      //E[k－2]项
  27   1        //存储当前误差以便后面计算
  28   1        sptr->PrevError = sptr->LastError;
  29   1        sptr->LastError = iError;
  30   1        //返回增量值
  31   1        return (PID_Adjust);
  32   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    311    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       5
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
